[{"path":"/articles/mixWCE.html","id":"functionalities-of-the-package","dir":"Articles","previous_headings":"","what":"Functionalities of the package","title":"Description of mixWCE package","text":"R package lcmm provides one function estimate statistical models based linear mixed model theory. includes estimation : exposition mixed models different type binary outcome models (WCEland), package mixWCE includes one main function: WCEland, estimates weighted cumulative effect time-varying exposure different types outcomes. includes binary outcomes, time--event (survival) data, conditional logistic models. dedicated vignette describes modeling context. model, maximum likelihood estimators obtained using default optimization algorithms provided standard R functions glm coxph, depending outcome type. weighting past exposure modeled flexible basis function approach. package also provides several post-fit functions, including summary outputs, plots estimated weight functions, simulation functions generate synthetic datasets various scenarios. question issue addressed GitHub page: https://github.com/MatheoLeFloch29/mixWCE/issues","code":""},{"path":"/articles/mixWCE.html","id":"calls-functions","dir":"Articles","previous_headings":"","what":"Calls functions","title":"Description of mixWCE package","text":"function isn’t precisely introduced companion paper.","code":""},{"path":"/articles/mixWCE.html","id":"wceland","dir":"Articles","previous_headings":"Calls functions","what":"WCEland","title":"Description of mixWCE package","text":"function used estimate weighted cumulative effect time-varying exposure different types outcomes, including binary, survival, conditional logistic models.","code":"WCEland(mexpo, var.time, time.frame, weightbasis, knots=NULL, knots.vector = NULL, data,reg.type, model, n_boot = 500)"},{"path":[]},{"path":"/articles/mixWCE.html","id":"paquid-subsample","dir":"Articles","previous_headings":"Dataset example","what":"paquid subsample","title":"Description of mixWCE package","text":"wikis, mixWCE illutrated paquid dataset. subsample 500 subjects original French prospective study Paquid. dataset can used epidemiological purposes subsample representative original cohort (particular, dementia cases sampled). visualizing data (head table ): different markers collected different times. dataset timescale timetime. obtaining quick summary data: variables missing values. problem using mixWCE package, missing value replace true value expositon variable delete outcome variable.","code":"head(paquid2)  [38;5;246m# A tibble: 6 × 14 [39m  [38;5;246m# Groups:   ID [2] [39m      ID  MMSE  BVRT   IST  HIER  CESD   age agedem   dem age_init   CEP  male    [3m [38;5;246m<int> [39m [23m  [3m [38;5;246m<dbl> [39m [23m  [3m [38;5;246m<int> [39m [23m  [3m [38;5;246m<dbl> [39m [23m  [3m [38;5;246m<int> [39m [23m  [3m [38;5;246m<int> [39m [23m  [3m [38;5;246m<dbl> [39m [23m   [3m [38;5;246m<dbl> [39m [23m  [3m [38;5;246m<int> [39m [23m     [3m [38;5;246m<dbl> [39m [23m  [3m [38;5;246m<int> [39m [23m  [3m [38;5;246m<int> [39m [23m  [38;5;250m1 [39m     1    26    10    37     2    11  68.5   68.5     0     68.5     1     1  [38;5;250m2 [39m     2    26    13    25     1    10  67.0   85.6     1     67.0     1     0  [38;5;250m3 [39m     2    28    13    28     1    15  69.1   85.6     1     67.0     1     0  [38;5;250m4 [39m     2    25    12    23     1    18  73.8   85.6     1     67.0     1     0  [38;5;250m5 [39m     2    24    13    16     3    22  84.1   85.6     1     67.0     1     0  [38;5;250m6 [39m     2    22     9    15     3     [31mNA [39m  87.1   85.6     1     67.0     1     0  [38;5;246m# ℹ 2 more variables: HIER2 <dbl>, time <dbl> [39m summary(paquid2)        ID             MMSE            BVRT            IST         Min.   :  1.0   Min.   : 0.00   Min.   : 0.00   Min.   : 5.00    1st Qu.:132.2   1st Qu.:25.00   1st Qu.: 9.00   1st Qu.:22.00    Median :263.0   Median :27.00   Median :11.00   Median :27.00    Mean   :256.2   Mean   :25.99   Mean   :10.78   Mean   :26.52    3rd Qu.:376.0   3rd Qu.:29.00   3rd Qu.:13.00   3rd Qu.:31.00    Max.   :500.0   Max.   :30.00   Max.   :15.00   Max.   :40.00                    NA's   :36      NA's   :300     NA's   :198           HIER            CESD             age             agedem       Min.   :0.000   Min.   : 0.000   Min.   : 66.28   Min.   :66.87    1st Qu.:1.000   1st Qu.: 2.000   1st Qu.: 75.09   1st Qu.:82.03    Median :1.000   Median : 6.000   Median : 80.57   Median :86.61    Mean   :1.272   Mean   : 8.488   Mean   : 80.53   Mean   :85.89    3rd Qu.:2.000   3rd Qu.:12.000   3rd Qu.: 85.77   3rd Qu.:89.94    Max.   :3.000   Max.   :52.000   Max.   :102.16   Max.   :99.49    NA's   :46      NA's   :146                                             dem            age_init          CEP              male         Min.   :0.0000   Min.   :66.28   Min.   :0.0000   Min.   :0.0000    1st Qu.:0.0000   1st Qu.:69.34   1st Qu.:0.0000   1st Qu.:0.0000    Median :0.0000   Median :73.67   Median :1.0000   Median :0.0000    Mean   :0.3329   Mean   :74.45   Mean   :0.7373   Mean   :0.3853    3rd Qu.:1.0000   3rd Qu.:78.57   3rd Qu.:1.0000   3rd Qu.:1.0000    Max.   :1.0000   Max.   :94.56   Max.   :1.0000   Max.   :1.0000                                                                            HIER2             time         Min.   :0.0000   Min.   : 0.000    1st Qu.:0.0000   1st Qu.: 1.722    Median :0.0000   Median : 4.283    Mean   :0.4011   Mean   : 6.073    3rd Qu.:1.0000   3rd Qu.: 9.261    Max.   :1.0000   Max.   :20.159    NA's   :46"},{"path":"/articles/mixWCE.html","id":"hier2-outcome","dir":"Articles","previous_headings":"Dataset example","what":"HIER2 outcome","title":"Description of mixWCE package","text":"mixWCE examples, HIER score usually considered outcome. HIER score physical dependency four levels: 0 (dependency), 1 (mild dependency), 2 (moderate dependency), 3 (severe dependency). binary models, outcome defined indicator moderate severe physical dependency, .e., HIER score greater equal 2.","code":""},{"path":[]},{"path":"/articles/WCE_model_binary.html","id":"modeling-the-exposure-trajectory","dir":"Articles","previous_headings":"background and definitions","what":"Modeling the Exposure Trajectory","title":"Estimate weight cumulative exposure effect for binary outcome","text":"assume true continuous exposure Ei*(t)E_{}^*(t) subject ii time tt follows normal distribution measurement noise. underlying true exposure follows linear mixed-effects model: Eij=Xi(t)⊤β+Zi(t)⊤bi⏟Ei*(tij)+εij E_{ij}=\\underbrace{X_i(t)^\\top\\beta + Z_{}(t)^\\top b_i}_{E_i^*(t_{ij})}+\\varepsilon_{ij} Xi(t)X_i(t) vector explanatory variables, β\\beta fixed effects, Zi(t)Z_i(t) subset Xi(t)X_i(t), bi∼Nb_i \\sim N(0,B) subject-specific random effects (B variance-covariance matrix). time evolution described either simple time function can describe natural cubic splines model flexible variations.","code":""},{"path":"/articles/WCE_model_binary.html","id":"event-modeling","dir":"Articles","previous_headings":"background and definitions","what":"Event Modeling","title":"Estimate weight cumulative exposure effect for binary outcome","text":"define WCIE (weighted cumulative exposure) subject ii weighted sum true exposure Ei*(t)E_{}^*(t) time window [−S,0][-S,0] unknown weights w(t)w(t) SS time window exposure. cumulative exposure included logistic model estimate probability individual case (Yi=1Y_i=1): logit(P(Yi=1))=α0+αpXip+WCIEi=α0+αpXip+∑t=−S0Ei*(t)×w(t)\\begin{align*}     \\text{logit}(P(Y_i=1)) &= \\alpha_0 + \\alpha_pX_{ip} + {WCIE_i}\\\\     &= \\alpha_0 + \\alpha_pX_{ip} + {\\sum_{t=-S}^{0} E_i^*(t) \\times w(t)}     \\label{eq7} \\end{align*} α0\\alpha_0 intercept, αp\\alpha_p coefficients covariates XipX_{ip}, sum represents weighted cumulative effect exposure.","code":""},{"path":"/articles/WCE_model_binary.html","id":"modeling-the-association","dir":"Articles","previous_headings":"background and definitions","what":"Modeling the Association","title":"Estimate weight cumulative exposure effect for binary outcome","text":"estimate exposure effects model, first need estimate weight function w(t)w(t). function expressed linear combination basis functions: w(t)=∑k=0KδkBk(t)w(t)= \\sum_{k=0}^{K} \\delta_k B_k(t) coefficients δk\\delta_k estimated B(k)B(k) basis functions. Estimating exposure effects means estimating coefficients δk\\delta_k, weight contributions basis function logistic model. vignette illustrates estimate weighted cumulative effect longitudinal exposition following methodology described Wagner et al. (2021 - https://doi.org/10.1186/s12874-021-01403-w).","code":""},{"path":"/articles/WCE_model_binary.html","id":"exemple-for-paquid-data","dir":"Articles","previous_headings":"","what":"Exemple for paquid data","title":"Estimate weight cumulative exposure effect for binary outcome","text":"example, study occurrence physical dependency defined HIER2 score Paquid dataset. HIER physical dependency score four levels: 0 (dependency), 1 (mild dependency), 2 (moderate dependency), 3 (severe dependency). binary models, outcome defined indicator moderate severe dependency, .e., HIER score greater equal 2. investigate effects exposure corresponding Mini-Mental State Examination (MMSE) score, psychometric test global cognitive functioning scored integer 0 30. sample includes elderly individuals followed time, adjustments possible covariates. Interactions considered .","code":""},{"path":[]},{"path":"/articles/WCE_model_binary.html","id":"exposition-variable-normalized-mmse","dir":"Articles","previous_headings":"Exemple for paquid data > paquid subset","what":"exposition variable: normalized MMSE","title":"Estimate weight cumulative exposure effect for binary outcome","text":"MMSE score highly skewed distribution, use normalized version, easily obtained using NormPsy package. normalization necessary satisfy assumptions linear mixed model used describe exposure trajectory, particularly assumption residuals (random effects) follow normal distribution.","code":"library(NormPsy) paquid2$normMMSE <- normMMSE(paquid2$MMSE)"},{"path":"/articles/WCE_model_binary.html","id":"split-dataset","dir":"Articles","previous_headings":"Exemple for paquid data > paquid subset","what":"split dataset","title":"Estimate weight cumulative exposure effect for binary outcome","text":"order obtain two time windows, split dataset two sub dataset. second one corresponding outcome windows keep one line per subject developp least moderate physical dependency (HIER >= 2), event appear t=0t=0 consider landmark fixed 10 years follow . second dataset corresponding entire exposition window event t=[−S,0]t=[-S,0] patient outcome.","code":"library(dplyr)   paquid_expo <- paquid2 %>%   arrange(ID, time) %>%   group_by(ID) %>%   filter(time<=10 & HIER2==0) %>%    mutate(time2=-10+time)   #transform the time variable   paquid_outcome <- paquid_expo %>%   select(ID) %>% distinct() %>%    inner_join(paquid2, by=\"ID\") %>%    arrange(ID, time) %>%                   group_by(ID) %>%    filter((time) >= 10) %>%      slice(     if (any(HIER2 == 1, na.rm = TRUE)) {       which(HIER2 == 1)[1]        # keep the first line when the patient develop the outcome     } else {       n()                 # else keep the last follow up mesure                   }   ) %>%    ungroup()  # keep exactly the same patient than outcome data paquid_expo <- paquid_outcome %>%    select(ID) %>%    inner_join(paquid_expo, by=\"ID\")"},{"path":"/articles/WCE_model_binary.html","id":"description-of-the-sample","dir":"Articles","previous_headings":"Exemple for paquid data > paquid subset","what":"Description of the sample","title":"Estimate weight cumulative exposure effect for binary outcome","text":"","code":"expo <- paquid_expo %>% group_by(ID) %>% arrange(time) %>%   filter(row_number()==1) summary(expo) #>        ID             MMSE            BVRT           IST        #>  Min.   :  2.0   Min.   :20.00   Min.   : 2.0   Min.   :16.00   #>  1st Qu.:132.0   1st Qu.:27.00   1st Qu.:10.0   1st Qu.:26.00   #>  Median :272.0   Median :28.00   Median :11.0   Median :30.00   #>  Mean   :261.5   Mean   :27.74   Mean   :11.4   Mean   :29.79   #>  3rd Qu.:384.0   3rd Qu.:29.00   3rd Qu.:13.0   3rd Qu.:33.25   #>  Max.   :500.0   Max.   :30.00   Max.   :15.0   Max.   :40.00   #>                  NA's   :1       NA's   :2      NA's   :1       #>       HIER             CESD             age            agedem      #>  Min.   :0.0000   Min.   : 0.000   Min.   :66.73   Min.   :74.42   #>  1st Qu.:0.0000   1st Qu.: 0.000   1st Qu.:69.08   1st Qu.:84.81   #>  Median :1.0000   Median : 4.000   Median :71.81   Median :87.70   #>  Mean   :0.6425   Mean   : 6.068   Mean   :73.00   Mean   :87.51   #>  3rd Qu.:1.0000   3rd Qu.: 9.000   3rd Qu.:76.48   3rd Qu.:90.50   #>  Max.   :1.0000   Max.   :27.000   Max.   :86.80   Max.   :99.49   #>                   NA's   :1                                        #>       dem            age_init          CEP              male            HIER2   #>  Min.   :0.0000   Min.   :66.73   Min.   :0.0000   Min.   :0.0000   Min.   :0   #>  1st Qu.:0.0000   1st Qu.:69.07   1st Qu.:1.0000   1st Qu.:0.0000   1st Qu.:0   #>  Median :0.0000   Median :71.43   Median :1.0000   Median :0.0000   Median :0   #>  Mean   :0.3731   Mean   :72.80   Mean   :0.7772   Mean   :0.3782   Mean   :0   #>  3rd Qu.:1.0000   3rd Qu.:76.35   3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:0   #>  Max.   :1.0000   Max.   :84.04   Max.   :1.0000   Max.   :1.0000   Max.   :0   #>                                                                                 #>       time           normMMSE          time2          #>  Min.   :0.0000   Min.   : 37.37   Min.   :-10.0000   #>  1st Qu.:0.0000   1st Qu.: 67.25   1st Qu.:-10.0000   #>  Median :0.0000   Median : 74.61   Median :-10.0000   #>  Mean   :0.1943   Mean   : 76.84   Mean   : -9.8057   #>  3rd Qu.:0.0000   3rd Qu.: 84.32   3rd Qu.:-10.0000   #>  Max.   :9.8124   Max.   :100.00   Max.   : -0.1876   #>                   NA's   :1  summary(paquid_outcome) #>        ID             MMSE            BVRT            IST        #>  Min.   :  2.0   Min.   : 1.00   Min.   : 4.00   Min.   : 5.00   #>  1st Qu.:132.0   1st Qu.:23.00   1st Qu.: 9.00   1st Qu.:20.00   #>  Median :272.0   Median :26.00   Median :11.00   Median :24.00   #>  Mean   :261.5   Mean   :24.82   Mean   :10.32   Mean   :23.73   #>  3rd Qu.:384.0   3rd Qu.:28.00   3rd Qu.:12.00   3rd Qu.:28.00   #>  Max.   :500.0   Max.   :30.00   Max.   :15.00   Max.   :40.00   #>                  NA's   :5       NA's   :40      NA's   :24      #>       HIER            CESD            age             agedem      #>  Min.   :0.000   Min.   : 0.00   Min.   : 78.42   Min.   :74.42   #>  1st Qu.:1.500   1st Qu.: 4.00   1st Qu.: 83.53   1st Qu.:84.81   #>  Median :2.000   Median : 9.00   Median : 86.86   Median :87.70   #>  Mean   :1.817   Mean   :10.66   Mean   : 86.90   Mean   :87.51   #>  3rd Qu.:2.000   3rd Qu.:15.00   3rd Qu.: 89.80   3rd Qu.:90.50   #>  Max.   :3.000   Max.   :49.00   Max.   :102.16   Max.   :99.49   #>  NA's   :2       NA's   :22                                       #>       dem            age_init          CEP              male        #>  Min.   :0.0000   Min.   :66.73   Min.   :0.0000   Min.   :0.0000   #>  1st Qu.:0.0000   1st Qu.:69.07   1st Qu.:1.0000   1st Qu.:0.0000   #>  Median :0.0000   Median :71.43   Median :1.0000   Median :0.0000   #>  Mean   :0.3731   Mean   :72.80   Mean   :0.7772   Mean   :0.3782   #>  3rd Qu.:1.0000   3rd Qu.:76.35   3rd Qu.:1.0000   3rd Qu.:1.0000   #>  Max.   :1.0000   Max.   :84.04   Max.   :1.0000   Max.   :1.0000   #>                                                                     #>      HIER2             time          normMMSE      #>  Min.   :0.0000   Min.   :10.39   Min.   :  2.91   #>  1st Qu.:0.5000   1st Qu.:11.48   1st Qu.: 47.40   #>  Median :1.0000   Median :13.58   Median : 61.18   #>  Mean   :0.7487   Mean   :14.10   Mean   : 61.16   #>  3rd Qu.:1.0000   3rd Qu.:16.36   3rd Qu.: 74.61   #>  Max.   :1.0000   Max.   :20.16   Max.   :100.00   #>  NA's   :2                        NA's   :5"},{"path":"/articles/WCE_model_binary.html","id":"models-considerd","dir":"Articles","previous_headings":"Exemple for paquid data","what":"Models considerd","title":"Estimate weight cumulative exposure effect for binary outcome","text":"First, consider following linear mixed model, ii subject jj repeated measurement: normMMSEij=β0+β1timeij+β2sexi+b0i+b1itimeij+εij normMMSE_{ij}= \\beta_0+\\beta_1time_{ij}+\\beta_2sex_{} + b_{0i}+b_{1i}time_{ij}+\\varepsilon_{ij}  bi∼(N)(0,b_{}\\sim \\mathcal(N)(0,B) εij∼N(0,σ2)\\varepsilon_{ij}\\sim N(0,\\sigma^2) Next, model occurrence physical dependency (HIER2 ≥ 2) using logistic regression including weighted cumulative exposure (WCE) term account time-dependent influence cognitive performance. model written : logit(P(HIERi=1))=α0+α1sexi+∑k=01δk∑t=−100Bk(t)×normMMSEi*(t) logit(P(HIER_i=1))=\\alpha_0+\\alpha_1sex_i+\\sum_{k=0}^1\\delta_k\\sum_{t=-10}^0B_k(t)\\times normMMSE_i^*(t) Bk(t)B_k(t) basis natural cubic splines 00 chosen internal knots.","code":""},{"path":"/articles/WCE_model_binary.html","id":"estimate-the-exposure-effect-with-0-knots","dir":"Articles","previous_headings":"Exemple for paquid data","what":"Estimate the exposure effect with 0 knots","title":"Estimate weight cumulative exposure effect for binary outcome","text":"begin, need fit linear mixed-effects exposure model using hlmehlme function lcmmlcmm package. second step, reuse linear mixed-effects model fitted exposure stage estimate time-varying effect exposure probability physical dependency. Specifically, apply WCElandWCEland function combine exposure model logistic regression framework, incorporating weighted cumulative exposure (WCE) structure. allows us capture past cognitive performance influences risk dependency time. conclude, chose use natural spline basis internal knots (.e., linear effect time) performed 10 bootstrap replications obtain bias-corrected variance estimates weighted cumulative exposure effects. number bootstrap samples intentionally limited 10 reduce computation time illustration, although larger number replications recommended practice stable variance estimation.","code":"library(lcmm) library(splines) library(mixWCE) library(ggplot2)  m_expo <- hlme(normMMSE~time2+male,              random = ~time2,              subject = \"ID\",data = paquid_expo,returndata = T)  m_outcome<-WCEland(mexpo = m_expo,var.time = \"time2\",time.frame = c(-10,0,1),weightbasis = \"NS\"               ,knots = 0,data = paquid_outcome               ,reg.type = \"logistic\",model = HIER2~male+WCIE,n_boot = 10)"},{"path":[]},{"path":"/articles/WCE_model_binary.html","id":"summary-of-the-model","dir":"Articles","previous_headings":"Exemple for paquid data > Description of the WCE model","what":"summary of the model","title":"Estimate weight cumulative exposure effect for binary outcome","text":"output presents full summary WCEland model fit. includes: Parameter Estimates (bootstrap-based): Coefficients outcome logistic model estimated using weighted bootstrap approach. include estimated coefficients, standard errors, Wald test statistics, p-values. Goodness--fit statistics: Global fit metrics maximum log-likelihood Akaike Information Criterion (AIC), help evaluate compare model adequacy. Variance-covariance matrix: Estimated variance-covariance matrix model parameters, useful inference understanding parameter correlations. Weighted cumulative exposure (WCE) effect summary: table showing time-specific estimated effects past exposure outcome. lag time, table includes effect estimate, standard error, Wald statistic, associated p-value. highlights influence exposure evolves time. Global WCE effect summary: Mean cumulative effect across time lags, standard error, overall Wald statistic, p-value — providing concise summary exposure effect entire time window.","code":"summary(m_outcome) #> Weighted Cumulative Index Estimation (WCEland)  #>      fitted by weighted bootstrap method  #>   #> glm(formula = HIER2 ~ male + (WCIE1 + WCIE2), family = binomial,      data = data.outcome)  #>   #> Outcome model type: logistic  #>   #> Statistical Model:  #>      Number of subjects: 192  #>      Number of subjects deleted: 1  #>   #> Weighting basis:  #> Number of bootstrap replications: 10  #> Time variable: time2  #> Knots for weight basis: 0  #>  #>   #> Parameter Estimates (bootstrap-based): #>   #>                 coef      Se   Wald p-value #> (Intercept)  7.70195 2.00609  3.839 0.00012 #> male        -1.17285 0.37185 -3.154 0.00161 #> WCIE1       -0.01164 0.00516 -2.257 0.02400 #> WCIE2       -0.04097 0.05554 -0.738 0.46073 #>   #> Summary of Goodness-of-fit statistics (over all bootstrap samples):   #>      maximum log-likelihood: -93.1438764863106   #>      AIC: 194.287752972621   #>   #> Variance-covariance matrix: #>   #>             (Intercept)          male         WCIE1        WCIE2 #> (Intercept)  4.02439649 -0.1369883752 -7.319050e-03 -0.023559956 #> male        -0.13698838  0.1382716833  3.232975e-04 -0.002474204 #> WCIE1       -0.00731905  0.0003232975  2.658739e-05 -0.000151466 #> WCIE2       -0.02355996 -0.0024742043 -1.514660e-04  0.003085069 #>   #>   #> Summary of weighted cumulative exposure effect: #>   #> Weighted cumulative exposure effect per time observation: #>   #>    Time   Effect      Se   Wald p-value #> 1   -10  0.01934 0.03652  0.530 0.59628 #> 2    -9  0.01399 0.02907  0.481 0.63041 #> 3    -8  0.00863 0.02165  0.399 0.68997 #> 4    -7  0.00328 0.01425  0.230 0.81796 #> 5    -6 -0.00208 0.00697 -0.298 0.76584 #> 6    -5 -0.00743 0.00234 -3.174 0.00150 #> 7    -4 -0.01279 0.00858 -1.490 0.13610 #> 8    -3 -0.01814 0.01590 -1.141 0.25399 #> 9    -2 -0.02350 0.02331 -1.008 0.31351 #> 10   -1 -0.02885 0.03075 -0.938 0.34804 #> 11    0 -0.03421 0.03819 -0.896 0.37039 #>   #>      Mean effect: -0.00743  #>      Se of effect: 0.00234  #>      Wald: -3.174  #>      p-value: 0.00150"},{"path":"/articles/WCE_model_binary.html","id":"plot-the-expsoition-trajectory-association","dir":"Articles","previous_headings":"Exemple for paquid data > Description of the WCE model","what":"plot the expsoition trajectory association","title":"Estimate weight cumulative exposure effect for binary outcome","text":"figure displays estimated weighted cumulative exposure (WCE) effect trajectory time. point x-axis represents specific time lag preceding outcome, y-axis shows estimated effect exposure time outcome. grey curve shows estimated time-varying exposure effect. shaded area represents 95% confidence interval around estimate, obtained bootstrap replicates using delta method. horizontal line zero helps visualize whether estimated effect statistically different effect.  plot displays estimated contribution past exposure log-odds experiencing outcome, assuming exposure levels time points held constant.","code":"plot(m_outcome)"},{"path":"/articles/WCE_model_binary.html","id":"estimate-the-exposure-effect-with-more-than-0-knots","dir":"Articles","previous_headings":"Exemple for paquid data","what":"Estimate the exposure effect with more than 0 knots","title":"Estimate weight cumulative exposure effect for binary outcome","text":"order use one internal knot WCElandWCEland function, time-dependent exposure must first modeled using flexible functions time. example, use natural cubic splines model time trajectory exposure hlmehlme function, allows greater flexibility consistency spline basis used weighted cumulative exposure framework. model selection, lower AIC suggests better-fitting model. Therefore, selected linear mixed model 1 internal knots.","code":"m_expo2 <- hlme(normMMSE~ns(time2,knots = c(-10),Boundary.knots = c(-19,-1))+male,              random = ~ns(time2,knots = c(-10),Boundary.knots = c(-19,-1)),              subject = \"ID\",data = paquid_expo,returndata = T)  m_expo3 <- hlme(normMMSE~ns(time2,knots = c(-13,-7),Boundary.knots = c(-19,-1))+male,              random = ~ns(time2,knots = c(-13,-7),Boundary.knots = c(-19,-1)),              subject = \"ID\",data = paquid_expo,returndata = T)  m_expo4 <- hlme(normMMSE~ns(time2,knots = c(-16,-12,-8,-4),Boundary.knots = c(-19,-1))+male,              random = ~ns(time2,knots = c(-16,-12,-8,-4),Boundary.knots = c(-19,-1)),              subject = \"ID\",data = paquid_expo,returndata = T)  m_expo2$AIC #> [1] 5630.255 m_expo3$AIC #> [1] 5637.312 m_expo4$AIC #> [1] 5660.193  m_outcome2 <- WCEland(mexpo = m_expo2,var.time = \"time2\",time.frame = c(-10,0,1),weightbasis = \"NS\"               ,knots = 1,data = paquid_outcome               ,reg.type = \"logistic\",model = HIER2~male+WCIE,n_boot = 10)"},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Beau Gosse. Author, maintainer.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Gosse B (2025). mixWCE: Weighted Cumulative Effect model Two-Level Bootstrap. R package version 0.1.0, https://github.com/MatheoLeFloch29/mixWCE.","code":"@Manual{,   title = {mixWCE: Weighted Cumulative Effect model with Two-Level Bootstrap},   author = {Beau Gosse},   year = {2025},   note = {R package version 0.1.0},   url = {https://github.com/MatheoLeFloch29/mixWCE}, }"},{"path":"/index.html","id":"id_--estimation-of-the-weighted-cumulative-effect-with-two-level-","dir":"","previous_headings":"","what":"Weighted Cumulative Effect model with Two-Level Bootstrap","title":"Weighted Cumulative Effect model with Two-Level Bootstrap","text":"  mixWCE package implements WCIE approach estimate effect time-varying exposure different types outcomes binary, survival, conditional logistic models. WCIE allows modeling influence past exposure using weighted cumulative framework. models estimated using default optimization algorithms implemented standard functions glm. package also includes functions simulate data, well utility tools complete statistical analysis. detailed companion paper isn’t available Journal Statistical Software :   ","code":""},{"path":"/index.html","id":"install-the-package","dir":"","previous_headings":"","what":"Install the package","title":"Weighted Cumulative Effect model with Two-Level Bootstrap","text":"mixWCE package needs version >= 3.5.0 newer R software. get recent update, install github (update think) : mixWCE package depends R package, namely : survival (>=2.37-2) dealing survival outcomes MASS lcmm splines ggplot2 dplyr run examples proposed website, following package also needed : ggplot2 dplyr splines  ","code":"remotes::install_github(\"MatheoLeFloch29/mixWCE\")"},{"path":"/index.html","id":"documentation","dir":"","previous_headings":"","what":"Documentation","title":"Weighted Cumulative Effect model with Two-Level Bootstrap","text":"website intended help mixWCE users statistical analyses. provides overview package, several vignettes, help pages functions included mixWCE package. issues questions use mixWCE package reported github issue page https://github.com/MatheoLeFloch29/mixWCE/issues. (update) Please check opened closed issues make sure topic already treated creating new issue. report bug, please provide reproducible example.","code":""},{"path":"/reference/doOneBootWCIE.html","id":null,"dir":"Reference","previous_headings":"","what":"Bootstrap Estimation of WCIE for a Single Replicate — doOneBootWCIE","title":"Bootstrap Estimation of WCIE for a Single Replicate — doOneBootWCIE","text":"internal function used perform one iteration bootstrap procedure estimating WCIE fitting corresponding outcome model using perturbed parameters.","code":""},{"path":"/reference/doOneBootWCIE.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bootstrap Estimation of WCIE for a Single Replicate — doOneBootWCIE","text":"","code":"doOneBootWCIE(   boot_params,   i,   times,   mexpo,   var.time,   weightbasis,   knots,   knots.vector,   data,   reg.type,   model )"},{"path":"/reference/doOneBootWCIE.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bootstrap Estimation of WCIE for a Single Replicate — doOneBootWCIE","text":"boot_params matrix data frame containing bootstrap parameter vectors. Integer. row index corresponding bootstrap sample boot_params. times Numeric vector length 4 indicating desired time window exposure (min, max, step, alea). mexpo object class hlme lcmm package, used model exposure process. object must created using hlme function specific arguments provided. fixed effects formula random effects formula must specified. subject argument must indicate subject ID, dataset must provided via data argument. essential include returnData = TRUE function call ensure internal data can accessed. var.time character indicating name time variable model mexpo. weightbasis Type temporal weighting function used estimate Weighted Cumulative Indirect Effects (WCIE). specifies functional form used model influence past exposures time. Currently, following options available: \"NS\" natural splines (implemented), \"BS\" B-splines (developed), \"PS\" P-splines (developed). knots number internal knots knots.vector list 2 vector : one internal knots splines (used splines temporal weighting function) second boundary knots. (ex:knots.vector=list(knots=c(-15,-5),boundary.knots=c(-20,0))) data data frame containing variables specified outcome model model including outcome variable. dataset used estimate outcome model, WCIE variables calculated previously added dataset prior model fitting. reg.type Type outcome model: \"logistic\", \"cox\", ... model two-sided linear formula object outcome model. response outcome left ~ covariates separated + right ~. include effect past exposure, must explicitly add WCIE (interaction terms WCIE:sex) formula. example, Y ~ WCIE + age + sex Y ~ WCIE:sex + age valid formulas.","code":""},{"path":"/reference/doOneBootWCIE.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bootstrap Estimation of WCIE for a Single Replicate — doOneBootWCIE","text":"list containing: coef Estimated coefficients outcome model. V Variance-covariance matrix (intra + inter) estimators. AIC AIC criteria outcome model. loglike log-likelihood outcome model.","code":""},{"path":"/reference/doOneBootWCIE.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Bootstrap Estimation of WCIE for a Single Replicate — doOneBootWCIE","text":"function takes set bootstrap parameters boot_params, reconstructs exposure model using parameters, estimates WCIE values. WCIE components used fit outcome model. returns estimated regression coefficients, variance-covariance matrix, AIC, log-likelihood outcome model.","code":""},{"path":"/reference/paquid.html","id":null,"dir":"Reference","previous_headings":"","what":"paquid Dataset — paquid","title":"paquid Dataset — paquid","text":"dataset contains paquid data including time-dependent exposures outcome.","code":""},{"path":"/reference/paquid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"paquid Dataset — paquid","text":"","code":"data(paquid)"},{"path":"/reference/paquid.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"paquid Dataset — paquid","text":"data frame 2250 observations 500 subjects 12 variable: ID subject identification number MMSE score Mini-Mental State Examination (MMSE), psychometric test global cognitive functioning (integer range 0-30) BVRT score Benton Visual Retention Test (BVRT), psychometric test spatial memory (integer range 0-15) IST score Isaacs Set Test (IST) truncated 15 seconds, test verbal memory (integer range 0-40) HIER score physical dependency (0=dependency, 1=mild dependency, 2=moderate dependency, 3=severe dependency) CESD score short self-report scale CES-D designed measure depressive symptomatology general population (integer range 0-52) age age follow-visit agedem age dementia diagnosis dem=1 last contact dem=0 dem indicator positive diagnosis dementia age_init age entry cohort CEP binary indicator educational level (CEP=1 subjects graduated primary school; CEP=0 otherwise) male binary indicator gender (male=1 men; male=0 women) HIER2 Indicator HIER score >= 2 time Time inclusion date (year)","code":""},{"path":"/reference/paquid2.html","id":null,"dir":"Reference","previous_headings":"","what":"paquid2 Dataset — paquid2","title":"paquid2 Dataset — paquid2","text":"dataset contains paquid2 data including time-dependent exposures outcome.","code":""},{"path":"/reference/paquid2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"paquid2 Dataset — paquid2","text":"","code":"data(paquid2)"},{"path":"/reference/paquid2.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"paquid2 Dataset — paquid2","text":"data frame 2250 observations 500 subjects 12 variable: ID subject identification number MMSE score Mini-Mental State Examination (MMSE), psychometric test global cognitive functioning (integer range 0-30) BVRT score Benton Visual Retention Test (BVRT), psychometric test spatial memory (integer range 0-15) IST score Isaacs Set Test (IST) truncated 15 seconds, test verbal memory (integer range 0-40) HIER score physical dependency (0=dependency, 1=mild dependency, 2=moderate dependency, 3=severe dependency) CESD score short self-report scale CES-D designed measure depressive symptomatology general population (integer range 0-52) age age follow-visit agedem age dementia diagnosis dem=1 last contact dem=0 dem indicator positive diagnosis dementia age_init age entry cohort CEP binary indicator educational level (CEP=1 subjects graduated primary school; CEP=0 otherwise) male binary indicator gender (male=1 men; male=0 women) HIER2 Indicator HIER score >= 2 time Time follow (year)","code":""},{"path":"/reference/plot.WCEland.html","id":null,"dir":"Reference","previous_headings":"","what":"summary.WCIE2F — plot.WCEland","title":"summary.WCIE2F — plot.WCEland","text":"summary.WCIE2F","code":""},{"path":"/reference/plot.WCEland.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"summary.WCIE2F — plot.WCEland","text":"","code":"# S3 method for class 'WCEland' plot(x, ...)"},{"path":"/reference/plot.WCEland.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"summary.WCIE2F — plot.WCEland","text":"x object class WCEland returned WCEland function. ... arguments (currently used).","code":""},{"path":"/reference/plot.WCEland.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"summary.WCIE2F — plot.WCEland","text":"Prints plot exposition historic effects estimates.","code":""},{"path":"/reference/plot.WCEland.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"summary.WCIE2F — plot.WCEland","text":"","code":"if (FALSE) { # \\dontrun{ } # }"},{"path":"/reference/plot.WCIE2F.html","id":null,"dir":"Reference","previous_headings":"","what":"summary.WCIE2F — plot.WCIE2F","title":"summary.WCIE2F — plot.WCIE2F","text":"summary.WCIE2F","code":""},{"path":"/reference/plot.WCIE2F.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"summary.WCIE2F — plot.WCIE2F","text":"","code":"# S3 method for class 'WCIE2F' plot(object, ...)"},{"path":"/reference/plot.WCIE2F.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"summary.WCIE2F — plot.WCIE2F","text":"object object class WCIE2F returned WCIE2F function. ... arguments (currently used).","code":""},{"path":"/reference/plot.WCIE2F.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"summary.WCIE2F — plot.WCIE2F","text":"Prints plot exposition historic effects estimates.","code":""},{"path":"/reference/plot.WCIE2F.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"summary.WCIE2F — plot.WCIE2F","text":"","code":"if (FALSE) { # \\dontrun{ } # }"},{"path":"/reference/simulateWCE.html","id":null,"dir":"Reference","previous_headings":"","what":"Data simulation according to different outcome models from WCIEpackage — simulateWCE","title":"Data simulation according to different outcome models from WCIEpackage — simulateWCE","text":"function simulates two sample, one exposition sample according model estimated hlme, functions outcome sample simulate relation effect exposition.","code":""},{"path":"/reference/simulateWCE.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Data simulation according to different outcome models from WCIEpackage — simulateWCE","text":"","code":"simulateWCE(   object,   nsim = 1,   seed = NULL,   times,   internal.step,   tname,   n,   Xbin = NULL,   Xcont = NULL,   weightbasis,   reg.type,   knots = NULL,   knots.vector = NULL,   model,   coef.wcie,   Xoutcome,   Surv.param = NULL )"},{"path":"/reference/simulateWCE.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Data simulation according to different outcome models from WCIEpackage — simulateWCE","text":"object object class hlme nsim simulation number seed random seed times either data frame 2 columns containing IDs measurement times, vector length 4 specifying minimal maximum measurement times, spacing 2 consecutive visits margin around spacing internal.step Time increment used high-resolution simulation resampling user's desired time step. tname name variable representing measurement times object. Default second column's name times data frame, object$var.time otherwise. n number subjects simulate* Xbin optional named list giving probabilities binary covariates simulate. list's names match binary covariate's names used object. Xcont optional named list giving mean standard deviation Gaussian covariates simulate. list's names match continuous covariate's names used object. weightbasis Type temporal weighting function used estimate Weighted Cumulative Indirect Effects (WCIE). specifies functional form used model influence past exposures time. Currently, following options available: \"NS\" natural splines (implemented), \"BS\" B-splines (developed), \"PS\" P-splines (developed). reg.type Type outcome model: \"logistic\", \"cox\", ... knots number internal knots knots.vector Vector internal knots splines (used splines temporal weighting function). model two-sided linear formula object outcome model. response outcome left ~ covariates separated + right ~. include effect past exposure, must explicitly add WCIE formula. example, Y ~ WCIE + age + sex valid formulas. coef.wcie named list giving parameters WCIE variables simulate. Xoutcome named list giving parameters intercept covariables logistic model simulate de outcome variable. list's names match intercept covariable names used object Surv.param named list giving parameter lambda simulate survival time variable upper limit uniform distribution used simulate censoring times. (ex. list(lambda=1,max_censoring_time=2.5))","code":""},{"path":"/reference/simulateWCE.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Data simulation according to different outcome models from WCIEpackage — simulateWCE","text":"exposition.data data frame one line per observation one column per variable.  Variables appears following order : subject id, measurement time, entry time, binary  covariates, continuous covariates, longitudinal outcomes. outcome.data data frame one line per individual one column per variable.  Variables appears following order : subject id, binary  covariates, continuous covariates, binary outcomes.","code":""},{"path":[]},{"path":"/reference/summary.WCEland.html","id":null,"dir":"Reference","previous_headings":"","what":"summary.WCEland — summary.WCEland","title":"summary.WCEland — summary.WCEland","text":"summary.WCEland","code":""},{"path":"/reference/summary.WCEland.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"summary.WCEland — summary.WCEland","text":"","code":"# S3 method for class 'WCEland' summary(object, ...)"},{"path":"/reference/summary.WCEland.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"summary.WCEland — summary.WCEland","text":"object object class WCEland returned WCEland function. ... arguments (currently used).","code":""},{"path":"/reference/summary.WCEland.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"summary.WCEland — summary.WCEland","text":"Prints summary WCEland analysis including model information, estimation results, bootstrap details.","code":""},{"path":"/reference/summary.WCEland.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"summary.WCEland — summary.WCEland","text":"","code":"if (FALSE) { # \\dontrun{ res <- WCEland(mexpo = mexpo,     var.time = \"TIME\",     timerange = c(0, 10),     data = data,     model = outcome_model) summary(res) } # }"},{"path":"/reference/summary.WCIE2F.html","id":null,"dir":"Reference","previous_headings":"","what":"summary.WCIE2F — summary.WCIE2F","title":"summary.WCIE2F — summary.WCIE2F","text":"summary.WCIE2F","code":""},{"path":"/reference/summary.WCIE2F.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"summary.WCIE2F — summary.WCIE2F","text":"","code":"# S3 method for class 'WCIE2F' summary(object, ...)"},{"path":"/reference/summary.WCIE2F.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"summary.WCIE2F — summary.WCIE2F","text":"object object class WCIE2F returned WCIE2F function. ... arguments (currently used).","code":""},{"path":"/reference/summary.WCIE2F.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"summary.WCIE2F — summary.WCIE2F","text":"Prints summary WCIE2F analysis including model information, estimation results, bootstrap details.","code":""},{"path":"/reference/summary.WCIE2F.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"summary.WCIE2F — summary.WCIE2F","text":"","code":"if (FALSE) { # \\dontrun{ res <- WCIE2F(mexpo = mexpo,     var.time = \"TIME\",     timerange = c(0, 10),     data = data,     model = outcome_model) summary(res) } # }"},{"path":"/reference/WCEland.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimation of the Weighted Cumulative Effect with Two-Level Bootstrap WCEland — WCEland","title":"Estimation of the Weighted Cumulative Effect with Two-Level Bootstrap WCEland — WCEland","text":"function estimates effects past exposure health outcome using WCIE method, accounting parameter uncertainty two-level bootstrap. uses longitudinal exposure model hlme outcome model compute time-weighted effects exposure.","code":""},{"path":"/reference/WCEland.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimation of the Weighted Cumulative Effect with Two-Level Bootstrap WCEland — WCEland","text":"","code":"WCEland(   mexpo,   var.time,   time.frame,   weightbasis = \"NS\",   knots = NULL,   knots.vector = NULL,   data,   reg.type = \"RL\",   model,   n_boot = 500 )"},{"path":"/reference/WCEland.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimation of the Weighted Cumulative Effect with Two-Level Bootstrap WCEland — WCEland","text":"mexpo object class hlme lcmm package, used model exposure process. object must created using hlme function specific arguments provided. fixed effects formula random effects formula must specified. subject argument must indicate subject ID, dataset must provided via data argument. essential include returnData = TRUE function call ensure internal data can accessed. var.time character indicating name time variable model mexpo. time.frame Numeric vector length 3 indicating desired time window exposure (min, max, step). weightbasis Type temporal weighting function used estimate Weighted Cumulative Indirect Effects (WCIE). specifies functional form used model influence past exposures time. Currently, following options available: \"NS\" natural splines (implemented), \"BS\" B-splines (developed), \"PS\" P-splines (developed). knots number internal knots knots.vector list 2 vector : one internal knots splines (used splines temporal weighting function) second boundary knots. (ex:knots.vector=list(knots=c(-15,-5),boundary.knots=c(-20,0))) data data frame containing variables specified outcome model model including outcome variable. dataset used estimate outcome model, WCIE variables calculated previously added dataset prior model fitting. reg.type Type outcome model: \"logistic\", \"cox\", ... model two-sided linear formula object outcome model. response outcome left ~ covariates separated + right ~. include effect past exposure, must explicitly add WCIE (interaction terms WCIE:sex) formula. example, Y ~ WCIE + age + sex Y ~ WCIE:sex + age valid formulas. n_boot Number bootstrap replicates perform (default = 500). Bootstrapping used approximate estimation uncertainty compute variance estimations.","code":""},{"path":"/reference/WCEland.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimation of the Weighted Cumulative Effect with Two-Level Bootstrap WCEland — WCEland","text":"list containing: estimate Table final outcome model estimators: mean (Estimate), standard error (Se), confidence intervals (con.low, conf.high), z-statistic, p-values. data.expo Intermediate data set individual predictions. data.outcome Data set used fit outcome model. effect.plot Graph representing estimate effects exposure history. exposition.effect Table estimate effects exposure history, standard error, IC mexpo Exposure model hlme object provided beginning. reg.type Type regression model used. mean.effect Mean effect exposure history. sd.mean.effect Variance mean effect exposure history time. nboot Number bootstrap replicates. call matched call outcome model. knots.quantile internal knots uses splines (used weightbasis = \"NS\"). V Variance-covariance matrix (intra + inter) estimators. var.time Name time variable used model. AIC Mean AIC outcome model across nboot bootstrap replicates. loglike Mean log-likelihood outcome model across nboot bootstrap replicates. n Number subjects. nb.subj.del Number subjects removed. time.processing Total computation time (proc.time() object).","code":""},{"path":"/reference/WCEland.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimation of the Weighted Cumulative Effect with Two-Level Bootstrap WCEland — WCEland","text":". estimation follows steps: (1) Extraction parameters mixed model mexpo : function extracts mean (mu) variance-covariance matrix (Sigma) estimated parameters using estimates() VarCov(). (2) Generation bootstrap parameter sets : Using multivariate normal random sampling (mvrnorm()), n_boot samples parameters simulated around estimated mean variance exposure model. (3) Cholesky transformation (necessary) : random effects correlated (.e., idiag = 0), Cholesky components transformed full variance-covariance matrices bootstrap. idiag = 1, variances adjusted squaring. (4) Repeated estimation WCIE outcome model : bootstrap parameter set, WCIE recalculated outcome model fitted.  step uses doOneBoot() function, returns iteration : estimated coefficients outcome model, intra-individual variance matrix. (5) Calculation bootstrap variances (Gelman-Rubin method) : total variance parameters decomposed follows : Intra-bootstrap variance : average variance matrices  iteration. Inter-bootstrap variance : dispersion estimators different  simulated parameter sets, calculated using Gelman-Rubin formula:   $$\\frac{n+1}{n(n-1)} \\sum_{=1}^n (\\theta_i - \\bar{\\theta})(\\theta_i - \\bar{\\theta})^T$$ Total variance : sum two components . (6) Construction confidence intervals p-values : total variance, corrected standard deviation calculated. 95 intervals, z-values, p-values produced parameter. (7) Temporal Exposure Effect Estimation : Based fitted model, WCIE effects computed linear combination splines weighted estimated coefficients. approach estimates time-varying effect past exposure specified time window (defined timerange). Two scenarios handled: Without interactions: effect time point given :   $$w(t) = B(t)^T \\theta$$   \\(B(t)\\) spline basis time \\(t\\), \\(\\theta\\) estimated WCIE coefficients. interactions: time-varying effect modified according covariates (e.g., sex, age) using model’s design matrix.   spline × covariate interaction terms incorporated :   $$w(t,x) = B(t)^T \\theta + \\sum_j B(t)^T \\theta_j x_j$$ (8) Uncertainty Quantification : variance WCIE effect time point computed using Delta method extended form interaction cases. variances allow construction 95 overall average effect across time window also estimated variance derived based average spline basis across time. (9) Graphical Representation : graphical output generated visualize estimated time-varying effect exposure along confidence interval. helps identify critical periods exposure significant impact outcome. B. USAGE PRECAUTIONS: (1) estimation WCIE relies quality exposure model provided mexpo. Since model used simulate exposure histories, incorrect specification fixed random effects may bias WCIE estimates. strongly recommended use natural splines (NS) time structure ensure returndata = TRUE specified hlme object. (2) weighting function used estimate WCIE time can lead instability overfitting number knots high time window (timerange) poorly chosen. Users inspect shape weight function consider simplifying convergence issues unreasonable effects detected. (3) bootstrap procedure used estimate standard errors can computationally intensive. large datasets many bootstrap replicates (n_boot), execution time may increase significantly. advised start smaller number replicates ensure model convergence increasing n_boot final inference. (4) Convergence problems can occur outcome model WCIE variables highly collinear, especially using fine time grid (step) many knots. model fails converge, consider reducing number time points complexity spline basis. (5) outcome model includes additional covariates interaction terms, care taken avoid overfitting misinterpretation WCIE effect. WCIE component interpreted marginal cumulative effect, conditional covariates model","code":""},{"path":"/reference/WCEland.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Estimation of the Weighted Cumulative Effect with Two-Level Bootstrap WCEland — WCEland","text":"Maud Wagner et al. “Time-varying associations exposure history subsequent health outcome : landmark approach identify critical windows”. : BMC Med Res Methodol (2021). doi : 10.1186/s12874-021-01403-w","code":""},{"path":[]},{"path":"/reference/WCEland.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Estimation of the Weighted Cumulative Effect with Two-Level Bootstrap WCEland — WCEland","text":"un super beau gosse","code":""},{"path":"/reference/WCIE2F.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimation of the Weighted Cumulative Effect with Two-Level — WCIE2F","title":"Estimation of the Weighted Cumulative Effect with Two-Level — WCIE2F","text":"function estimates effect exposure history health outcome (binary event, survival time, repeated event), using WCIE (Weighted Cumulative Index Exposure) approach. designed longitudinal data exposure varies time, goal model effect time-varying exposure outcome. . Estimation follows following steps: (1) Individual prediction exposure: Based mixed model mexpo, must object class hlme, individual exposure trajectories predicted user-defined time window (timerange) frequency (step). presence absence random intercept taken account, random effects must explicitly specified. temporal structure (e.g., splines, polynomials) used original model preserved, must directly included mexpo model. (2) Reconstruction exposure history: temporal weighting basis used construct WCIE, .e., time-weighted exposure scores. Currently, natural splines (NS) implemented. spline knots automatically  computed based time quantiles, according number internal knots (knots)  specified user. (3) Computation WCIE: WCIE corresponds weighted sum products time spline basis functions  predicted exposure values. spline generates separate WCIE component (e.g., WCIE1, WCIE2, ...). (4) Outcome modeling: model fitted outcome, incorporating WCIE components explanatory variables. Two types models currently available via reg.type argument: - \"logistic\": logistic regression (GLM model) - \"cox\": Cox proportional hazards model (development) final formula automatically reconstructed based original model, replacing exposure term sum WCIE components. function output includes: - fitted outcome model (glm), - temporal predictions (Ypred) random effects, - time quantiles used splines, - final formula used outcome model. B. USAGE PRECAUTIONS: (1) estimation WCIE relies quality exposure model provided mexpo. Since model used simulate exposure histories, incorrect specification fixed random effects may bias WCIE estimates. strongly recommended use natural splines (NS) time structure ensure returndata = TRUE specified hlme object. (2) weighting function used estimate WCIE time can lead instability overfitting number knots high time window (timerange) poorly chosen. Users inspect shape weight function consider simplifying convergence issues unreasonable effects detected. (3) Convergence problems can occur outcome model WCIE variables highly collinear, especially using fine time grid (step) many knots. model fails converge, consider reducing number time points complexity spline basis.","code":""},{"path":"/reference/WCIE2F.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimation of the Weighted Cumulative Effect with Two-Level — WCIE2F","text":"","code":"WCIE2F(   mexpo,   var.time,   times,   weightbasis,   knots,   knots.vector,   data,   reg.type,   model )"},{"path":"/reference/WCIE2F.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimation of the Weighted Cumulative Effect with Two-Level — WCIE2F","text":"mexpo object class hlme lcmm package, used model exposure process. object must created using hlme function specific arguments provided. fixed effects formula random effects formula must specified. subject argument must indicate subject ID, dataset must provided via data argument. essential include returnData = TRUE function call ensure internal data can accessed. var.time character indicating name time variable also exposition outcome data model mexpo. times Numeric vector length 4 indicating desired time window exposure (min, max, step, alea). weightbasis Type temporal weighting function used estimate Weighted Cumulative Indirect Effects (WCIE). specifies functional form used model influence past exposures time. Currently, following options available: \"NS\" natural splines (implemented), \"BS\" B-splines (developed), \"PS\" P-splines (developed). knots number internal knots knots.vector list 2 vector : one internal knots splines (used splines temporal weighting function) second boundary knots. (ex:knots.vector=list(knots=c(-15,-5),boundary.knots=c(-20,0))) data data frame containing variables specified outcome model model including outcome variable. dataset used estimate outcome model, WCIE variables calculated previously added dataset prior model fitting. reg.type Type outcome model: \"logistic\", \"cox\", ... model two-sided linear formula object outcome model. response outcome left ~ covariates separated + right ~. include effect past exposure, must explicitly add WCIE (interaction terms WCIE:sex) formula. example, Y ~ WCIE + age + sex Y ~ WCIE:sex + age valid formulas.","code":""},{"path":"/reference/WCIE2F.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimation of the Weighted Cumulative Effect with Two-Level — WCIE2F","text":"list containing: model outcome model object data_expo Intermediate data set individual predictions. mexpo Exposure model hlme object provided beginning. data_outcome Data set used fit outcome model. call matched call outcome model. splines.quantiles internal quantiles used natural splines,   define time-weighting function. boundary.quantiles lower upper bounds natural splines   (5th 95th percentiles), used define limits time-weighting function. AIC AIC criteria outcome model. loglike log-likelihood outcome model.","code":""},{"path":"/reference/WCIE2F.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Estimation of the Weighted Cumulative Effect with Two-Level — WCIE2F","text":"Maud Wagner et al. “Time-varying associations exposure history subsequent health outcome : landmark approach identify critical windows”. : BMC Med Res Methodol (2021). doi : 10.1186/s12874-021-01403-w","code":""},{"path":[]},{"path":"/reference/WCIE2F.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Estimation of the Weighted Cumulative Effect with Two-Level — WCIE2F","text":"Encore un giga beau gosse","code":""}]
