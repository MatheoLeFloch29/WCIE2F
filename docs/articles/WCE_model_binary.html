<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Estimate weight cumulative exposure effect for binary outcome • mixWCE</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate weight cumulative exposure effect for binary outcome">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mixWCE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/mixWCE.html">GET STARTED</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">VIGNETTES</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/WCE_model_binary.html">Estimate weight cumulative exposure effect for binary outcome</a></li>
    <li><a class="dropdown-item" href="../articles/WCE_model_survival.html">Estimate weight cumulative exposure effect for a survival outcome</a></li>
    <li><a class="dropdown-item" href="../articles/WCE_model_conditional_binary.html">Estimate weight cumulative exposure effect for a conditional binary outcome</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">REFERENCE</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/MatheoLeFloch29/mixWCE/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Estimate weight cumulative exposure effect for binary outcome</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MatheoLeFloch29/mixWCE/blob/HEAD/vignettes/WCE_model_binary.Rmd" class="external-link"><code>vignettes/WCE_model_binary.Rmd</code></a></small>
      <div class="d-none name"><code>WCE_model_binary.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="background-and-definitions">background and definitions<a class="anchor" aria-label="anchor" href="#background-and-definitions"></a>
</h2>
<div class="section level3">
<h3 id="modeling-the-exposure-trajectory">Modeling the Exposure Trajectory<a class="anchor" aria-label="anchor" href="#modeling-the-exposure-trajectory"></a>
</h3>
<p>We assume the true continuous exposure
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>E</mi><mi>i</mi><mo>*</mo></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">E_{i}^*(t)</annotation></semantics></math>
of subject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
follows a normal distribution with measurement noise. The underlying
true exposure follows a linear mixed-effects model:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><munder><munder><mrow><msub><mi>X</mi><mi>i</mi></msub><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>⊤</mi></msup><mi>β</mi><mo>+</mo><msub><mi>Z</mi><mi>i</mi></msub><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>⊤</mi></msup><msub><mi>b</mi><mi>i</mi></msub></mrow><mo accent="true">⏟</mo></munder><mrow><msubsup><mi>E</mi><mi>i</mi><mo>*</mo></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></munder><mo>+</mo><msub><mi>ε</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex"> E_{ij}=\underbrace{X_i(t)^\top\beta + Z_{i}(t)^\top b_i}_{E_i^*(t_{ij})}+\varepsilon_{ij} </annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">X_i(t)</annotation></semantics></math>
is the vector of explanatory variables,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
the fixed effects,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Z_i(t)</annotation></semantics></math>
a subset of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">X_i(t)</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub><mo>∼</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">b_i \sim N</annotation></semantics></math>(0,B)
are subject-specific random effects (B is the variance-covariance
matrix). The time evolution is described either by a simple time
function but that can be describe by natural cubic splines to model more
flexible variations.</p>
</div>
<div class="section level3">
<h3 id="event-modeling">Event Modeling<a class="anchor" aria-label="anchor" href="#event-modeling"></a>
</h3>
<p>We define the WCIE (weighted cumulative exposure) for subject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
as the weighted sum of the true exposure
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>E</mi><mi>i</mi><mo>*</mo></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">E_{i}^*(t)</annotation></semantics></math>
over a time window
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mi>−</mi><mi>S</mi><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[-S,0]</annotation></semantics></math>
with unknown weights
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">w(t)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math>
the time window exposure.</p>
<p>This cumulative exposure is then included in a logistic model to
estimate the probability that the individual is a case
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">Y_i=1</annotation></semantics></math>):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">logit</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>α</mi><mn>0</mn></msub><mo>+</mo><msub><mi>α</mi><mi>p</mi></msub><msub><mi>X</mi><mrow><mi>i</mi><mi>p</mi></mrow></msub><mo>+</mo><mrow><mi>W</mi><mi>C</mi><mi>I</mi><msub><mi>E</mi><mi>i</mi></msub></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>α</mi><mn>0</mn></msub><mo>+</mo><msub><mi>α</mi><mi>p</mi></msub><msub><mi>X</mi><mrow><mi>i</mi><mi>p</mi></mrow></msub><mo>+</mo><mrow><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mi>−</mi><mi>S</mi></mrow><mn>0</mn></munderover><msubsup><mi>E</mi><mi>i</mi><mo>*</mo></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>×</mo><mi>w</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
    \text{logit}(P(Y_i=1)) &amp;= \alpha_0 + \alpha_pX_{ip} + {WCIE_i}\\
    &amp;= \alpha_0 + \alpha_pX_{ip} + {\sum_{t=-S}^{0} E_i^*(t) \times w(t)}
    \label{eq7}
\end{align*}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>α</mi><mn>0</mn></msub><annotation encoding="application/x-tex">\alpha_0</annotation></semantics></math>
is the intercept,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>α</mi><mi>p</mi></msub><annotation encoding="application/x-tex">\alpha_p</annotation></semantics></math>
are the coefficients of covariates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mi>i</mi><mi>p</mi></mrow></msub><annotation encoding="application/x-tex">X_{ip}</annotation></semantics></math>,
and the sum represents the weighted cumulative effect of exposure.</p>
</div>
<div class="section level3">
<h3 id="modeling-the-association">Modeling the Association<a class="anchor" aria-label="anchor" href="#modeling-the-association"></a>
</h3>
<p>To estimate the exposure effects in the model, we first need to
estimate the weight function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">w(t)</annotation></semantics></math>.
This function is expressed as a linear combination of basis
functions:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mi>K</mi></munderover><msub><mi>δ</mi><mi>k</mi></msub><msub><mi>B</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">w(t)= \sum_{k=0}^{K} \delta_k B_k(t)</annotation></semantics></math></p>
<p>where the coefficients
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>δ</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\delta_k</annotation></semantics></math>
are to be estimated and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">B(k)</annotation></semantics></math>
a basis functions.</p>
<p>Estimating the exposure effects means estimating the coefficients
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>δ</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\delta_k</annotation></semantics></math>,
which weight the contributions of each basis function in the logistic
model.</p>
<p>This vignette illustrates how to estimate weighted cumulative effect
of a longitudinal exposition following the methodology described in
Wagner et al. (2021 - <a href="https://doi.org/10.1186/s12874-021-01403-w" class="external-link uri">https://doi.org/10.1186/s12874-021-01403-w</a>).</p>
</div>
</div>
<div class="section level2">
<h2 id="exemple-for-paquid-data">Exemple for paquid data<a class="anchor" aria-label="anchor" href="#exemple-for-paquid-data"></a>
</h2>
<p>In this example, we study the occurrence of physical dependency
defined by the HIER2 score from the Paquid dataset. HIER is a physical
dependency score with four levels: 0 (no dependency), 1 (mild
dependency), 2 (moderate dependency), and 3 (severe dependency). For
binary models, the outcome is defined as an indicator of moderate to
severe dependency, i.e., a HIER score greater than or equal to 2. We
investigate the effects of an exposure corresponding to the Mini-Mental
State Examination (MMSE) score, a psychometric test of global cognitive
functioning scored as an integer between 0 and 30. The sample includes
elderly individuals followed over time, with adjustments possible for
covariates. Interactions are not considered here.</p>
<div class="section level3">
<h3 id="paquid-subset">paquid subset<a class="anchor" aria-label="anchor" href="#paquid-subset"></a>
</h3>
<div class="section level4">
<h4 id="exposition-variable-normalized-mmse">exposition variable: normalized MMSE<a class="anchor" aria-label="anchor" href="#exposition-variable-normalized-mmse"></a>
</h4>
<p>As the MMSE score has a highly skewed distribution, we use its
normalized version, which is easily obtained using the NormPsy package.
This normalization is necessary to satisfy the assumptions of the linear
mixed model used to describe the exposure trajectory, particularly the
assumption that the residuals (and random effects) follow a normal
distribution.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">NormPsy</span><span class="op">)</span></span>
<span><span class="va">paquid2</span><span class="op">$</span><span class="va">normMMSE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/NormPsy/man/normMMSE.html" class="external-link">normMMSE</a></span><span class="op">(</span><span class="va">paquid2</span><span class="op">$</span><span class="va">MMSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="split-dataset">split dataset<a class="anchor" aria-label="anchor" href="#split-dataset"></a>
</h4>
<p>In order to obtain our two time windows, we split the dataset in two
sub dataset. The second one corresponding to the outcome windows and
keep one line per subject when he developp at least a moderate physical
dependency (HIER &gt;= 2), this event appear after
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t=0</annotation></semantics></math>
consider as the landmark fixed at 10 years of follow up. The second
dataset corresponding to the entire exposition window before this event
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mi>−</mi><mi>S</mi><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">t=[-S,0]</annotation></semantics></math>
which no patient have the outcome.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">paquid_expo</span> <span class="op">&lt;-</span> <span class="va">paquid2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">time</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ID</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">time</span><span class="op">&lt;=</span><span class="fl">10</span> <span class="op">&amp;</span> <span class="va">HIER2</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>time2<span class="op">=</span><span class="op">-</span><span class="fl">10</span><span class="op">+</span><span class="va">time</span><span class="op">)</span>   <span class="co">#transform the time variable</span></span>
<span></span>
<span></span>
<span><span class="va">paquid_outcome</span> <span class="op">&lt;-</span> <span class="va">paquid_expo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ID</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span><span class="va">paquid2</span>, by<span class="op">=</span><span class="st">"ID"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">time</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>                </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ID</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>   </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">HIER2</span> <span class="op">==</span> <span class="fl">1</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">HIER2</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>        <span class="co"># keep the first line when the patient develop the outcome</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>                 <span class="co"># else keep the last follow up mesure              </span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># keep exactly the same patient than outcome data</span></span>
<span><span class="va">paquid_expo</span> <span class="op">&lt;-</span> <span class="va">paquid_outcome</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ID</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span><span class="va">paquid_expo</span>, by<span class="op">=</span><span class="st">"ID"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="description-of-the-sample">Description of the sample<a class="anchor" aria-label="anchor" href="#description-of-the-sample"></a>
</h4>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">expo</span> <span class="op">&lt;-</span> <span class="va">paquid_expo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ID</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/row_number.html" class="external-link">row_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">expo</span><span class="op">)</span></span>
<span><span class="co">#&gt;        ID             MMSE            BVRT           IST       </span></span>
<span><span class="co">#&gt;  Min.   :  2.0   Min.   :20.00   Min.   : 2.0   Min.   :16.00  </span></span>
<span><span class="co">#&gt;  1st Qu.:132.0   1st Qu.:27.00   1st Qu.:10.0   1st Qu.:26.00  </span></span>
<span><span class="co">#&gt;  Median :272.0   Median :28.00   Median :11.0   Median :30.00  </span></span>
<span><span class="co">#&gt;  Mean   :261.5   Mean   :27.74   Mean   :11.4   Mean   :29.79  </span></span>
<span><span class="co">#&gt;  3rd Qu.:384.0   3rd Qu.:29.00   3rd Qu.:13.0   3rd Qu.:33.25  </span></span>
<span><span class="co">#&gt;  Max.   :500.0   Max.   :30.00   Max.   :15.0   Max.   :40.00  </span></span>
<span><span class="co">#&gt;                  NA's   :1       NA's   :2      NA's   :1      </span></span>
<span><span class="co">#&gt;       HIER             CESD             age            agedem     </span></span>
<span><span class="co">#&gt;  Min.   :0.0000   Min.   : 0.000   Min.   :66.73   Min.   :74.42  </span></span>
<span><span class="co">#&gt;  1st Qu.:0.0000   1st Qu.: 0.000   1st Qu.:69.08   1st Qu.:84.81  </span></span>
<span><span class="co">#&gt;  Median :1.0000   Median : 4.000   Median :71.81   Median :87.70  </span></span>
<span><span class="co">#&gt;  Mean   :0.6425   Mean   : 6.068   Mean   :73.00   Mean   :87.51  </span></span>
<span><span class="co">#&gt;  3rd Qu.:1.0000   3rd Qu.: 9.000   3rd Qu.:76.48   3rd Qu.:90.50  </span></span>
<span><span class="co">#&gt;  Max.   :1.0000   Max.   :27.000   Max.   :86.80   Max.   :99.49  </span></span>
<span><span class="co">#&gt;                   NA's   :1                                       </span></span>
<span><span class="co">#&gt;       dem            age_init          CEP              male            HIER2  </span></span>
<span><span class="co">#&gt;  Min.   :0.0000   Min.   :66.73   Min.   :0.0000   Min.   :0.0000   Min.   :0  </span></span>
<span><span class="co">#&gt;  1st Qu.:0.0000   1st Qu.:69.07   1st Qu.:1.0000   1st Qu.:0.0000   1st Qu.:0  </span></span>
<span><span class="co">#&gt;  Median :0.0000   Median :71.43   Median :1.0000   Median :0.0000   Median :0  </span></span>
<span><span class="co">#&gt;  Mean   :0.3731   Mean   :72.80   Mean   :0.7772   Mean   :0.3782   Mean   :0  </span></span>
<span><span class="co">#&gt;  3rd Qu.:1.0000   3rd Qu.:76.35   3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:0  </span></span>
<span><span class="co">#&gt;  Max.   :1.0000   Max.   :84.04   Max.   :1.0000   Max.   :1.0000   Max.   :0  </span></span>
<span><span class="co">#&gt;                                                                                </span></span>
<span><span class="co">#&gt;       time           normMMSE          time2         </span></span>
<span><span class="co">#&gt;  Min.   :0.0000   Min.   : 37.37   Min.   :-10.0000  </span></span>
<span><span class="co">#&gt;  1st Qu.:0.0000   1st Qu.: 67.25   1st Qu.:-10.0000  </span></span>
<span><span class="co">#&gt;  Median :0.0000   Median : 74.61   Median :-10.0000  </span></span>
<span><span class="co">#&gt;  Mean   :0.1943   Mean   : 76.84   Mean   : -9.8057  </span></span>
<span><span class="co">#&gt;  3rd Qu.:0.0000   3rd Qu.: 84.32   3rd Qu.:-10.0000  </span></span>
<span><span class="co">#&gt;  Max.   :9.8124   Max.   :100.00   Max.   : -0.1876  </span></span>
<span><span class="co">#&gt;                   NA's   :1</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">paquid_outcome</span><span class="op">)</span></span>
<span><span class="co">#&gt;        ID             MMSE            BVRT            IST       </span></span>
<span><span class="co">#&gt;  Min.   :  2.0   Min.   : 1.00   Min.   : 4.00   Min.   : 5.00  </span></span>
<span><span class="co">#&gt;  1st Qu.:132.0   1st Qu.:23.00   1st Qu.: 9.00   1st Qu.:20.00  </span></span>
<span><span class="co">#&gt;  Median :272.0   Median :26.00   Median :11.00   Median :24.00  </span></span>
<span><span class="co">#&gt;  Mean   :261.5   Mean   :24.82   Mean   :10.32   Mean   :23.73  </span></span>
<span><span class="co">#&gt;  3rd Qu.:384.0   3rd Qu.:28.00   3rd Qu.:12.00   3rd Qu.:28.00  </span></span>
<span><span class="co">#&gt;  Max.   :500.0   Max.   :30.00   Max.   :15.00   Max.   :40.00  </span></span>
<span><span class="co">#&gt;                  NA's   :5       NA's   :40      NA's   :24     </span></span>
<span><span class="co">#&gt;       HIER            CESD            age             agedem     </span></span>
<span><span class="co">#&gt;  Min.   :0.000   Min.   : 0.00   Min.   : 78.42   Min.   :74.42  </span></span>
<span><span class="co">#&gt;  1st Qu.:1.500   1st Qu.: 4.00   1st Qu.: 83.53   1st Qu.:84.81  </span></span>
<span><span class="co">#&gt;  Median :2.000   Median : 9.00   Median : 86.86   Median :87.70  </span></span>
<span><span class="co">#&gt;  Mean   :1.817   Mean   :10.66   Mean   : 86.90   Mean   :87.51  </span></span>
<span><span class="co">#&gt;  3rd Qu.:2.000   3rd Qu.:15.00   3rd Qu.: 89.80   3rd Qu.:90.50  </span></span>
<span><span class="co">#&gt;  Max.   :3.000   Max.   :49.00   Max.   :102.16   Max.   :99.49  </span></span>
<span><span class="co">#&gt;  NA's   :2       NA's   :22                                      </span></span>
<span><span class="co">#&gt;       dem            age_init          CEP              male       </span></span>
<span><span class="co">#&gt;  Min.   :0.0000   Min.   :66.73   Min.   :0.0000   Min.   :0.0000  </span></span>
<span><span class="co">#&gt;  1st Qu.:0.0000   1st Qu.:69.07   1st Qu.:1.0000   1st Qu.:0.0000  </span></span>
<span><span class="co">#&gt;  Median :0.0000   Median :71.43   Median :1.0000   Median :0.0000  </span></span>
<span><span class="co">#&gt;  Mean   :0.3731   Mean   :72.80   Mean   :0.7772   Mean   :0.3782  </span></span>
<span><span class="co">#&gt;  3rd Qu.:1.0000   3rd Qu.:76.35   3rd Qu.:1.0000   3rd Qu.:1.0000  </span></span>
<span><span class="co">#&gt;  Max.   :1.0000   Max.   :84.04   Max.   :1.0000   Max.   :1.0000  </span></span>
<span><span class="co">#&gt;                                                                    </span></span>
<span><span class="co">#&gt;      HIER2             time          normMMSE     </span></span>
<span><span class="co">#&gt;  Min.   :0.0000   Min.   :10.39   Min.   :  2.91  </span></span>
<span><span class="co">#&gt;  1st Qu.:0.5000   1st Qu.:11.48   1st Qu.: 47.40  </span></span>
<span><span class="co">#&gt;  Median :1.0000   Median :13.58   Median : 61.18  </span></span>
<span><span class="co">#&gt;  Mean   :0.7487   Mean   :14.10   Mean   : 61.16  </span></span>
<span><span class="co">#&gt;  3rd Qu.:1.0000   3rd Qu.:16.36   3rd Qu.: 74.61  </span></span>
<span><span class="co">#&gt;  Max.   :1.0000   Max.   :20.16   Max.   :100.00  </span></span>
<span><span class="co">#&gt;  NA's   :2                        NA's   :5</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="models-considerd">Models considerd<a class="anchor" aria-label="anchor" href="#models-considerd"></a>
</h3>
<p>First, We consider the following linear mixed model, where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
is the subject and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
the repeated measurement:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi>M</mi><mi>M</mi><mi>S</mi><msub><mi>E</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>β</mi><mn>0</mn></msub><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><mi>t</mi><mi>i</mi><mi>m</mi><msub><mi>e</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><mi>s</mi><mi>e</mi><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><msub><mi>b</mi><mrow><mn>0</mn><mi>i</mi></mrow></msub><mo>+</mo><msub><mi>b</mi><mrow><mn>1</mn><mi>i</mi></mrow></msub><mi>t</mi><mi>i</mi><mi>m</mi><msub><mi>e</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>ε</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex"> normMMSE_{ij}= \beta_0+\beta_1time_{ij}+\beta_2sex_{i} + b_{0i}+b_{1i}time_{ij}+\varepsilon_{ij} </annotation></semantics></math>
Where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub><mo>∼</mo><mi mathvariant="script">(</mi><mi>N</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo>,</mo></mrow><annotation encoding="application/x-tex">b_{i}\sim \mathcal(N)(0,</annotation></semantics></math>B)
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ε</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\varepsilon_{ij}\sim N(0,\sigma^2)</annotation></semantics></math></p>
<p>Next, we model the occurrence of physical dependency (HIER2 ≥ 2)
using a logistic regression including a weighted cumulative exposure
(WCE) term to account for the time-dependent influence of cognitive
performance. The model is written as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>H</mi><mi>I</mi><mi>E</mi><msub><mi>R</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>α</mi><mn>0</mn></msub><mo>+</mo><msub><mi>α</mi><mn>1</mn></msub><mi>s</mi><mi>e</mi><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mn>1</mn></munderover><msub><mi>δ</mi><mi>k</mi></msub><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mi>−</mi><mn>10</mn></mrow><mn>0</mn></munderover><msub><mi>B</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>×</mo><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi>M</mi><mi>M</mi><mi>S</mi><msubsup><mi>E</mi><mi>i</mi><mo>*</mo></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> logit(P(HIER_i=1))=\alpha_0+\alpha_1sex_i+\sum_{k=0}^1\delta_k\sum_{t=-10}^0B_k(t)\times normMMSE_i^*(t)</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">B_k(t)</annotation></semantics></math>
is a basis of natural cubic splines with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn><annotation encoding="application/x-tex">0</annotation></semantics></math>
chosen internal knots.</p>
</div>
<div class="section level3">
<h3 id="estimate-the-exposure-effect-with-0-knots">Estimate the exposure effect with 0 knots<a class="anchor" aria-label="anchor" href="#estimate-the-exposure-effect-with-0-knots"></a>
</h3>
<p>To begin, we need to fit a linear mixed-effects exposure model using
the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mi>l</mi><mi>m</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">hlme</annotation></semantics></math>
function from the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>c</mi><mi>m</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">lcmm</annotation></semantics></math>
package. In the second step, we reuse the linear mixed-effects model
fitted in the exposure stage to estimate the time-varying effect of the
exposure on the probability of physical dependency. Specifically, we
apply the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>C</mi><mi>E</mi><mi>l</mi><mi>a</mi><mi>n</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">WCEland</annotation></semantics></math>
function to combine the exposure model with a logistic regression
framework, incorporating a weighted cumulative exposure (WCE) structure.
This allows us to capture how past cognitive performance influences the
risk of dependency over time. To conclude, we chose to use a natural
spline basis with no internal knots (i.e., a linear effect over time)
and performed 10 bootstrap replications to obtain bias-corrected
variance estimates for the weighted cumulative exposure effects. The
number of bootstrap samples was intentionally limited to 10 to reduce
computation time during this illustration, although a larger number of
replications would be recommended in practice for more stable variance
estimation.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://cecileproust-lima.github.io/lcmm/" class="external-link">lcmm</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">splines</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MatheoLeFloch29/mixWCE" class="external-link">mixWCE</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_expo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://cecileproust-lima.github.io/lcmm/reference/hlme.html" class="external-link">hlme</a></span><span class="op">(</span><span class="va">normMMSE</span><span class="op">~</span><span class="va">time2</span><span class="op">+</span><span class="va">male</span>,</span>
<span>             random <span class="op">=</span> <span class="op">~</span><span class="va">time2</span>,</span>
<span>             subject <span class="op">=</span> <span class="st">"ID"</span>,data <span class="op">=</span> <span class="va">paquid_expo</span>,returndata <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_outcome</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/WCEland.html">WCEland</a></span><span class="op">(</span>mexpo <span class="op">=</span> <span class="va">m_expo</span>,var.time <span class="op">=</span> <span class="st">"time2"</span>,time.frame <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,weightbasis <span class="op">=</span> <span class="st">"NS"</span></span>
<span>              ,knots <span class="op">=</span> <span class="fl">0</span>,data <span class="op">=</span> <span class="va">paquid_outcome</span></span>
<span>              ,reg.type <span class="op">=</span> <span class="st">"logistic"</span>,model <span class="op">=</span> <span class="va">HIER2</span><span class="op">~</span><span class="va">male</span><span class="op">+</span><span class="va">WCIE</span>,n_boot <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="description-of-the-wce-model">Description of the WCE model<a class="anchor" aria-label="anchor" href="#description-of-the-wce-model"></a>
</h3>
<div class="section level4">
<h4 id="summary-of-the-model">summary of the model<a class="anchor" aria-label="anchor" href="#summary-of-the-model"></a>
</h4>
<p>The output above presents the full summary of the WCEland model fit.
It includes:</p>
<ul>
<li><p><strong>Parameter Estimates (bootstrap-based):</strong>
Coefficients of the outcome logistic model estimated using a weighted
bootstrap approach. These include the estimated coefficients, standard
errors, Wald test statistics, and p-values.</p></li>
<li><p><strong>Goodness-of-fit statistics:</strong> Global fit metrics
such as the maximum log-likelihood and the Akaike Information Criterion
(AIC), which help evaluate and compare model adequacy.</p></li>
<li><p><strong>Variance-covariance matrix:</strong> Estimated
variance-covariance matrix of the model parameters, useful for inference
and understanding parameter correlations.</p></li>
<li><p><strong>Weighted cumulative exposure (WCE) effect
summary:</strong> A table showing the time-specific estimated effects of
past exposure on the outcome. For each lag time, the table includes the
effect estimate, its standard error, the Wald statistic, and the
associated p-value. This highlights how the influence of the exposure
evolves over time.</p></li>
<li><p><strong>Global WCE effect summary:</strong> Mean cumulative
effect across time lags, its standard error, the overall Wald statistic,
and p-value — providing a concise summary of the exposure effect over
the entire time window.</p></li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m_outcome</span><span class="op">)</span></span>
<span><span class="co">#&gt; Weighted Cumulative Index Estimation (WCEland) </span></span>
<span><span class="co">#&gt;      fitted by weighted bootstrap method </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; glm(formula = HIER2 ~ male + (WCIE1 + WCIE2), family = binomial,      data = data.outcome) </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Outcome model type: logistic </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Statistical Model: </span></span>
<span><span class="co">#&gt;      Number of subjects: 192 </span></span>
<span><span class="co">#&gt;      Number of subjects deleted: 1 </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Weighting basis: </span></span>
<span><span class="co">#&gt; Number of bootstrap replications: 10 </span></span>
<span><span class="co">#&gt; Time variable: time2 </span></span>
<span><span class="co">#&gt; Knots for weight basis: 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Parameter Estimates (bootstrap-based):</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;                 coef      Se   Wald p-value</span></span>
<span><span class="co">#&gt; (Intercept)  7.70195 2.00609  3.839 0.00012</span></span>
<span><span class="co">#&gt; male        -1.17285 0.37185 -3.154 0.00161</span></span>
<span><span class="co">#&gt; WCIE1       -0.01164 0.00516 -2.257 0.02400</span></span>
<span><span class="co">#&gt; WCIE2       -0.04097 0.05554 -0.738 0.46073</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Summary of Goodness-of-fit statistics (over all bootstrap samples):  </span></span>
<span><span class="co">#&gt;      maximum log-likelihood: -93.1438764863106  </span></span>
<span><span class="co">#&gt;      AIC: 194.287752972621  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Variance-covariance matrix:</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;             (Intercept)          male         WCIE1        WCIE2</span></span>
<span><span class="co">#&gt; (Intercept)  4.02439649 -0.1369883752 -7.319050e-03 -0.023559956</span></span>
<span><span class="co">#&gt; male        -0.13698838  0.1382716833  3.232975e-04 -0.002474204</span></span>
<span><span class="co">#&gt; WCIE1       -0.00731905  0.0003232975  2.658739e-05 -0.000151466</span></span>
<span><span class="co">#&gt; WCIE2       -0.02355996 -0.0024742043 -1.514660e-04  0.003085069</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Summary of weighted cumulative exposure effect:</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Weighted cumulative exposure effect per time observation:</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;    Time   Effect      Se   Wald p-value</span></span>
<span><span class="co">#&gt; 1   -10  0.01934 0.03652  0.530 0.59628</span></span>
<span><span class="co">#&gt; 2    -9  0.01399 0.02907  0.481 0.63041</span></span>
<span><span class="co">#&gt; 3    -8  0.00863 0.02165  0.399 0.68997</span></span>
<span><span class="co">#&gt; 4    -7  0.00328 0.01425  0.230 0.81796</span></span>
<span><span class="co">#&gt; 5    -6 -0.00208 0.00697 -0.298 0.76584</span></span>
<span><span class="co">#&gt; 6    -5 -0.00743 0.00234 -3.174 0.00150</span></span>
<span><span class="co">#&gt; 7    -4 -0.01279 0.00858 -1.490 0.13610</span></span>
<span><span class="co">#&gt; 8    -3 -0.01814 0.01590 -1.141 0.25399</span></span>
<span><span class="co">#&gt; 9    -2 -0.02350 0.02331 -1.008 0.31351</span></span>
<span><span class="co">#&gt; 10   -1 -0.02885 0.03075 -0.938 0.34804</span></span>
<span><span class="co">#&gt; 11    0 -0.03421 0.03819 -0.896 0.37039</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;      Mean effect: -0.00743 </span></span>
<span><span class="co">#&gt;      Se of effect: 0.00234 </span></span>
<span><span class="co">#&gt;      Wald: -3.174 </span></span>
<span><span class="co">#&gt;      p-value: 0.00150</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="plot-the-expsoition-trajectory-association">plot the expsoition trajectory association<a class="anchor" aria-label="anchor" href="#plot-the-expsoition-trajectory-association"></a>
</h4>
<p>The figure displays the estimated <strong>weighted cumulative
exposure (WCE) effect</strong> trajectory over time. Each point on the
x-axis represents a specific time lag preceding the outcome, while the
y-axis shows the estimated effect of exposure at that time on the
outcome.</p>
<ul>
<li>The <strong>grey curve</strong> shows the estimated time-varying
exposure effect.</li>
<li>The <strong>shaded area</strong> represents the 95% confidence
interval around the estimate, obtained through bootstrap replicates and
by using a delta method.</li>
<li>The <strong>horizontal line at zero</strong> helps visualize whether
the estimated effect is statistically different from no effect.</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">m_outcome</span><span class="op">)</span></span></code></pre></div>
<p><img src="WCE_model_binary_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>This plot displays the estimated contribution of past exposure to the
<strong>log-odds</strong> of experiencing the outcome, assuming exposure
levels at all other time points are held constant.</p>
</div>
</div>
<div class="section level3">
<h3 id="estimate-the-exposure-effect-with-more-than-0-knots">Estimate the exposure effect with more than 0 knots<a class="anchor" aria-label="anchor" href="#estimate-the-exposure-effect-with-more-than-0-knots"></a>
</h3>
<p>In order to use more than one internal knot in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>C</mi><mi>E</mi><mi>l</mi><mi>a</mi><mi>n</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">WCEland</annotation></semantics></math>
function, the time-dependent exposure must first be modeled using
flexible functions of time. In this example, we use natural cubic
splines to model the time trajectory of the exposure in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mi>l</mi><mi>m</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">hlme</annotation></semantics></math>
function, which allows for greater flexibility and consistency with the
spline basis used in the weighted cumulative exposure framework.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">m_expo2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://cecileproust-lima.github.io/lcmm/reference/hlme.html" class="external-link">hlme</a></span><span class="op">(</span><span class="va">normMMSE</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">time2</span>,knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span><span class="op">)</span>,Boundary.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">19</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="va">male</span>,</span>
<span>             random <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">time2</span>,knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span><span class="op">)</span>,Boundary.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">19</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             subject <span class="op">=</span> <span class="st">"ID"</span>,data <span class="op">=</span> <span class="va">paquid_expo</span>,returndata <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_expo3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://cecileproust-lima.github.io/lcmm/reference/hlme.html" class="external-link">hlme</a></span><span class="op">(</span><span class="va">normMMSE</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">time2</span>,knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">13</span>,<span class="op">-</span><span class="fl">7</span><span class="op">)</span>,Boundary.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">19</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="va">male</span>,</span>
<span>             random <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">time2</span>,knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">13</span>,<span class="op">-</span><span class="fl">7</span><span class="op">)</span>,Boundary.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">19</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             subject <span class="op">=</span> <span class="st">"ID"</span>,data <span class="op">=</span> <span class="va">paquid_expo</span>,returndata <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_expo4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://cecileproust-lima.github.io/lcmm/reference/hlme.html" class="external-link">hlme</a></span><span class="op">(</span><span class="va">normMMSE</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">time2</span>,knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">16</span>,<span class="op">-</span><span class="fl">12</span>,<span class="op">-</span><span class="fl">8</span>,<span class="op">-</span><span class="fl">4</span><span class="op">)</span>,Boundary.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">19</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="va">male</span>,</span>
<span>             random <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">time2</span>,knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">16</span>,<span class="op">-</span><span class="fl">12</span>,<span class="op">-</span><span class="fl">8</span>,<span class="op">-</span><span class="fl">4</span><span class="op">)</span>,Boundary.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">19</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             subject <span class="op">=</span> <span class="st">"ID"</span>,data <span class="op">=</span> <span class="va">paquid_expo</span>,returndata <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_expo2</span><span class="op">$</span><span class="va">AIC</span></span>
<span><span class="co">#&gt; [1] 5630.255</span></span>
<span><span class="va">m_expo3</span><span class="op">$</span><span class="va">AIC</span></span>
<span><span class="co">#&gt; [1] 5637.312</span></span>
<span><span class="va">m_expo4</span><span class="op">$</span><span class="va">AIC</span></span>
<span><span class="co">#&gt; [1] 5660.193</span></span>
<span></span>
<span><span class="va">m_outcome2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/WCEland.html">WCEland</a></span><span class="op">(</span>mexpo <span class="op">=</span> <span class="va">m_expo2</span>,var.time <span class="op">=</span> <span class="st">"time2"</span>,time.frame <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,weightbasis <span class="op">=</span> <span class="st">"NS"</span></span>
<span>              ,knots <span class="op">=</span> <span class="fl">1</span>,data <span class="op">=</span> <span class="va">paquid_outcome</span></span>
<span>              ,reg.type <span class="op">=</span> <span class="st">"logistic"</span>,model <span class="op">=</span> <span class="va">HIER2</span><span class="op">~</span><span class="va">male</span><span class="op">+</span><span class="va">WCIE</span>,n_boot <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p>In model selection, a lower AIC suggests a better-fitting model.
Therefore, we selected the linear mixed model with 1 internal knots.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Beau Gosse.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
